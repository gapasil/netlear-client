{"ast":null,"code":"import _regeneratorRuntime from\"/var/www/netlear/html/clientNetlear/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/var/www/netlear/html/clientNetlear/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import axios from\"axios\";import{url}from\"../../conf\";export var AddUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(objUser,img,cb,cbb,method){var date,eror,blob,newFile,dataa;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:date=Date.now();if(img){objUser.avatar=\"\".concat(date).concat(img.name);}else{objUser.avatar=\"defaultimg.jpg\";}eror=function eror(result){result.errors.errors.map(function(obj,index){var objErr={};var ref=obj.param;var message=obj.msg;objErr.message=message;objErr.ref=ref;cb(objErr);});};if(method==\"email\"){delete objUser.phoneNumber;fetch(\"\".concat(url,\"auth/registeremail\"),{method:\"POST\",headers:{'Content-Type':'application/json;charset=utf-8'},body:JSON.stringify(objUser)}).then(function(responce){return responce.json();}).then(function(result){if(result.errors){eror(result);}{cbb(result.message);}});}else{delete objUser.email;fetch(\"\".concat(url,\"auth/registerphone\"),{method:\"POST\",headers:{'Content-Type':'application/json;charset=utf-8'},body:JSON.stringify(objUser)}).then(function(responce){return responce.json();}).then(function(result){if(result.errors){eror(result);}{cbb(result.message);}});}if(!img){_context.next=11;break;}//изменение названия картинки \nblob=img.slice(0,img.size,'image/png');newFile=new File([blob],\"\".concat(date).concat(img.name),{type:'image/png'});dataa=new FormData();dataa.append(\"avatar\",newFile);_context.next=11;return axios.post(\"\".concat(url,\"auth/uploadavatar\"),dataa,{headers:{'Content-Type':'multipart/form-data'}});case 11:case\"end\":return _context.stop();}}},_callee);}));return function AddUser(_x,_x2,_x3,_x4,_x5){return _ref.apply(this,arguments);};}();","map":{"version":3,"names":["axios","url","AddUser","objUser","img","cb","cbb","method","date","Date","now","avatar","name","eror","result","errors","map","obj","index","objErr","ref","param","message","msg","phoneNumber","fetch","headers","body","JSON","stringify","then","responce","json","email","blob","slice","size","newFile","File","type","dataa","FormData","append","post"],"sources":["/var/www/netlear/html/clientNetlear/src/components/RegForm/funcReg.js"],"sourcesContent":["import axios from \"axios\";\nimport { url } from \"../../conf\"\nexport const AddUser = async (objUser,img,cb,cbb,method) =>{\n  const date = Date.now()\n\n  if(img){\n    objUser.avatar = `${date}${img.name}`\n  }else{\n    objUser.avatar = \"defaultimg.jpg\"\n  }\n  let eror = (result) =>{\n    result.errors.errors.map((obj,index)=>{\n      const objErr = {}\n      let ref = obj.param\n      let message = obj.msg\n      objErr.message = message\n      objErr.ref = ref\n      cb(objErr)\n    })\n  }\n  if(method == \"email\"){\n    delete objUser.phoneNumber\n    fetch(`${url}auth/registeremail`,{\n      method:\"POST\",\n      headers: {\n        'Content-Type': 'application/json;charset=utf-8',\n      },\n      body: JSON.stringify(objUser)\n    })\n    .then(responce =>{\n      return responce.json()\n    })\n    .then(result => {\n      if(result.errors){eror(result)}\n      {cbb(result.message)}\n    })\n  }else{\n    delete objUser.email\n    fetch(`${url}auth/registerphone`,{\n      method:\"POST\",\n      headers: {\n        'Content-Type': 'application/json;charset=utf-8',\n      },\n      body: JSON.stringify(objUser)\n    })\n    .then(responce =>{\n      return responce.json()\n    })\n    .then(result => {\n      if(result.errors){eror(result)}\n      {cbb(result.message)}\n    })\n  }\n\n  if(img){  \n    //изменение названия картинки \n    const blob = img.slice(0, img.size, 'image/png'); \n    const newFile = new File([blob], `${date}${img.name}`, {type: 'image/png'});\n    const dataa = new FormData()\n\n    dataa.append(\"avatar\", newFile)\n\n    await axios.post(`${url}auth/uploadavatar`,dataa,{\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    })\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}