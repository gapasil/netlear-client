{"ast":null,"code":"import _createForOfIteratorHelper from\"/var/www/netlear/html/clientNetlear/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _slicedToArray from\"/var/www/netlear/html/clientNetlear/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import'./DeployCourseBlock.scss';import{url}from\"../../conf\";import Button from'../Button/Button';import EventDeployPanel from'../EventDeployPanel/EventDeployPanel';import{useDispatch,useSelector}from'react-redux';import{setVideosFromRedactor}from'../../redux/actions/UploadingCourse/UploadingCourse';import{Modal}from'antd';import{jsx as _jsx}from\"react/jsx-runtime\";function DeployCourseBlock(_ref){var props=_ref.props;var eventRedactor=useSelector(function(state){return state.eventRedactor;});var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),isDeployPanelOpen=_React$useState2[0],setIsDeployPanelOpen=_React$useState2[1];var onDeployCourseData=function onDeployCourseData(){var speaker=eventRedactor.aboutSpeaker.data;var banner=eventRedactor.banner.data;var main=eventRedactor.mainContent.data;var vebinars=eventRedactor.mainContent.data.vebinars;var masVebin=[];var index=1;var form=new FormData();var dataURLtoFile=function dataURLtoFile(dataurl,filename){if(dataurl.length>60){var arr=dataurl.split(','),mime=arr[0].match(/:(.*?);/)[1],bstr=atob(arr[1]),n=bstr.length,u8arr=new Uint8Array(n);while(n--){u8arr[n]=bstr.charCodeAt(n);}return new File([u8arr],filename,{type:mime});}};var backgroundImg=dataURLtoFile(banner.backgroundImg,\"backgroundImg\");var _iterator=_createForOfIteratorHelper(vebinars),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var key=_step.value;var objVebinars={title:key.title,description:key.content,date:key.date,photo:key.promoImg,typeOfContent:key.format,paymentMethod:{paymentType:key.isPaid?\"Платный контент\":\"Бесплатный контент\",price:key.cost,currency:key.currency,promocode:key.promoCode,promocodeDiscount:key.personalDiscount},video:{video:key.video,videoName:key.videoName,videoDescription:key.videoDescription}};var vebinarPhoto=dataURLtoFile(key.promoImg,\"vebinarPhoto\");if(vebinarPhoto){form.append(\"vebinarPhoto\".concat(index),vebinarPhoto);}if(key.video){form.append(\"vebinarVideo\".concat(index),key.video);}masVebin.push(objVebinars);index+=1;}}catch(err){_iterator.e(err);}finally{_iterator.f();}var course={backgroundTitle:backgroundImg,mainTitle:banner.title,type:props,speakerTitle:banner.speakerName,speakerTitleParagraph:banner.speakerShortDescription,aboutCourse:{title:main.youWillLearn.title,paragraph:main.youWillLearn.content},program:{title:main.eventProgram.title,paragraph:main.eventProgram.content},vebinars:masVebin,fullCoursePayCard:{cost:main.fullCoursePayCard.cost,currency:main.fullCoursePayCard.currency,discount:main.fullCoursePayCard.discount,costWithDiscount:main.fullCoursePayCard.costWithDiscount,promocode:main.fullCoursePayCard.promoCode,promoCodeDiscount:main.fullCoursePayCard.promoCodeDiscount},speaker:{name:speaker.fullName,profession:speaker.career,paragraph:speaker.description,promoVideoName:speaker.videoName,photo:speaker.img,promoVideo:speaker.video}};var speakerImg=dataURLtoFile(speaker.img,\"speakerImg\");if(speakerImg){form.append(\"speakerPhoto\",speakerImg);}if(speaker.video.size){form.append(\"speakerVideo\",speaker.video);}if(backgroundImg){form.append(\"backgroundTitle\",backgroundImg);}form.append(\"body\",JSON.stringify(course));// for(let key of form.entries()){\n//   console.log(key);\n// }\nfetch(\"\".concat(url,\"post/add\"),{headers:{\"Authorization\":\"Bearer \".concat(localStorage.getItem(\"token\"))},method:\"POST\",body:form}).then(function(res){return res.json();}).then(function(result){return console.log(result);});setIsDeployPanelOpen(true);};if(isDeployPanelOpen){return/*#__PURE__*/_jsx(\"div\",{});}return/*#__PURE__*/_jsx(\"div\",{className:\"deploy-course\",children:/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:onDeployCourseData,text:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435 \\u043E \\u043A\\u0443\\u0440\\u0441\\u0435 \\u043D\\u0430 \\u0440\\u0430\\u0441\\u0441\\u043C\\u043E\\u0442\\u0440\\u0435\\u043D\\u0438\\u0435\"})});}export default DeployCourseBlock;","map":{"version":3,"names":["React","useEffect","useState","url","Button","EventDeployPanel","useDispatch","useSelector","setVideosFromRedactor","Modal","DeployCourseBlock","props","eventRedactor","state","isDeployPanelOpen","setIsDeployPanelOpen","onDeployCourseData","speaker","aboutSpeaker","data","banner","main","mainContent","vebinars","masVebin","index","form","FormData","dataURLtoFile","dataurl","filename","length","arr","split","mime","match","bstr","atob","n","u8arr","Uint8Array","charCodeAt","File","type","backgroundImg","key","objVebinars","title","description","content","date","photo","promoImg","typeOfContent","format","paymentMethod","paymentType","isPaid","price","cost","currency","promocode","promoCode","promocodeDiscount","personalDiscount","video","videoName","videoDescription","vebinarPhoto","append","push","course","backgroundTitle","mainTitle","speakerTitle","speakerName","speakerTitleParagraph","speakerShortDescription","aboutCourse","youWillLearn","paragraph","program","eventProgram","fullCoursePayCard","discount","costWithDiscount","promoCodeDiscount","name","fullName","profession","career","promoVideoName","img","promoVideo","speakerImg","size","JSON","stringify","fetch","headers","localStorage","getItem","method","body","then","res","json","result","console","log"],"sources":["/var/www/netlear/html/clientNetlear/src/components/DeployCourseBlock/DeployCourseBlock.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport './DeployCourseBlock.scss';\nimport { url } from \"../../conf\"\nimport Button from '../Button/Button';\nimport EventDeployPanel from '../EventDeployPanel/EventDeployPanel';\n\nimport { useDispatch, useSelector } from 'react-redux';\nimport { setVideosFromRedactor } from '../../redux/actions/UploadingCourse/UploadingCourse';\nimport { Modal } from 'antd';\n\nfunction DeployCourseBlock({props}) {\n  const eventRedactor = useSelector((state) => state.eventRedactor);\n  const [isDeployPanelOpen, setIsDeployPanelOpen] = React.useState(false);\n\n  const onDeployCourseData = () => {\n    const speaker  = eventRedactor.aboutSpeaker.data\n    const banner   = eventRedactor.banner.data\n    const main     = eventRedactor.mainContent.data\n    const vebinars = eventRedactor.mainContent.data.vebinars\n    const masVebin = []\n    let index = 1\n    const form = new FormData()\n    \n    const dataURLtoFile = (dataurl, filename) => {\n      if(dataurl.length > 60){\n  \t    let arr = dataurl.split(','),\n\t        mime = arr[0].match(/:(.*?);/)[1],\n\t        bstr = atob(arr[1]),\n\t        n = bstr.length,\n\t        u8arr = new Uint8Array(n);\n\t      while (n--) {\n\t       u8arr[n] = bstr.charCodeAt(n);\n\t      }\n\t      return new File([u8arr], filename, { type: mime });\n      }\n\t  }\n  \n    const backgroundImg = dataURLtoFile(banner.backgroundImg, \"backgroundImg\")\n\n    for(let key of vebinars){\n      const objVebinars = {\n        title: key.title,\n        description: key.content,\n        date : key.date,\n        photo: key.promoImg,\n        typeOfContent: key.format,\n        paymentMethod: {\n          paymentType: key.isPaid?\"Платный контент\":\"Бесплатный контент\",\n          price      : key.cost ,\n          currency   : key.currency,\n          promocode  : key.promoCode,\n          promocodeDiscount: key.personalDiscount\n        },\n        video: {\n          video : key.video,\n          videoName : key.videoName,\n          videoDescription : key.videoDescription\n        }\n      }\n      let vebinarPhoto = dataURLtoFile(key.promoImg, \"vebinarPhoto\");\n      if(vebinarPhoto){\n        form.append(`vebinarPhoto${index}`,vebinarPhoto)\n      }\n      if(key.video){\n        form.append(`vebinarVideo${index}`,key.video)\n      }\n      masVebin.push(objVebinars)\n      index += 1\n    }\n\n    const course = {\n      backgroundTitle: backgroundImg,\n      mainTitle: banner.title,\n      type: props,\n      speakerTitle: banner.speakerName,\n      speakerTitleParagraph: banner.speakerShortDescription,\n      aboutCourse: {\n        title: main.youWillLearn.title,\n        paragraph:main.youWillLearn.content\n      },\n      program: {\n        title: main.eventProgram.title,\n        paragraph:main.eventProgram.content\n      },\n      vebinars: masVebin,\n      fullCoursePayCard: {\n        cost: main.fullCoursePayCard.cost,\n        currency: main.fullCoursePayCard.currency,\n        discount: main.fullCoursePayCard.discount,\n        costWithDiscount: main.fullCoursePayCard.costWithDiscount,\n        promocode: main.fullCoursePayCard.promoCode,\n        promoCodeDiscount: main.fullCoursePayCard.promoCodeDiscount\n      },\n      speaker: {\n        name: speaker.fullName,\n        profession: speaker.career,\n        paragraph:speaker.description,\n        promoVideoName: speaker.videoName,\n        photo:speaker.img,\n        promoVideo:speaker.video\n      }\n    }\n    const speakerImg = dataURLtoFile(speaker.img, \"speakerImg\");\n    if(speakerImg){\n      form.append(\"speakerPhoto\",speakerImg)\n    }\n    if(speaker.video.size){\n      form.append(\"speakerVideo\",speaker.video)\n    }\n    if(backgroundImg){\n      form.append(\"backgroundTitle\",backgroundImg)\n    }\n    form.append(\"body\",JSON.stringify(course))\n\n    // for(let key of form.entries()){\n    //   console.log(key);\n    // }\n\n    fetch(`${url}post/add`,{\n      headers: {\n        \"Authorization\": `Bearer ${localStorage.getItem(\"token\")}`\n      },\n      method: \"POST\",\n      body: form\n    })\n    .then((res)=>res.json())\n    .then((result)=>console.log(result))\n    setIsDeployPanelOpen(true);\n  };\n  if(isDeployPanelOpen){\n    return (\n      <div>\n        \n      </div>\n    )\n  }\n  return (\n    <div className=\"deploy-course\">\n      <Button type=\"primary\" onClick={onDeployCourseData} text=\"Загрузить данные о курсе на рассмотрение\"/>\n    </div>\n  );\n}\n\nexport default DeployCourseBlock;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}