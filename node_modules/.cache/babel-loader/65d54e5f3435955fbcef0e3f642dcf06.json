{"ast":null,"code":"import _objectSpread from\"/var/www/netlear/html/clientNetlear/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/var/www/netlear/html/clientNetlear/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import\"./App.scss\";import\"antd/dist/antd.css\";// or 'antd/dist/antd.less'\nimport{BrowserRouter as Router,withRouter,Switch,Route}from\"react-router-dom\";import{HomePage,AskQuestionPage,SpecialistsPage,EventsPage,EventPage,EditUserProfile,UserProfile,AuthGoogleToken,AuthFacebookToken,AuthCheckKey,Tariffs}from\"./views\";import NotFound from\"./views/NotFound/NotFound\";import Header from\"./views/Header/Header\";import LoginForm from\"./components/LoginForm/LoginForm\";import RegForm from\"./components/RegForm/RegForm\";import{useDispatch,useSelector,connect}from\"react-redux\";import store from\"./redux/store\";import Footer from\"./components/Footer/Footer\";import{url}from\"./conf\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(_ref){var history=_ref.history;var dispatch=useDispatch();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),sd=_useState2[0],setList=_useState2[1];var token=localStorage.getItem('token');var user=useSelector(function(state){return state.Auth;});var abortController=new AbortController();// const getUser = (method,value) =>{\n//   if(token){\n//     fetch(`${url}useroute/user/`,{\n//       method:\"POST\",\n//       headers: {\n//         'Content-Type': 'application/json;charset=utf-8',\n//         \"Authorization\":`Bearer ${token}`\n//       },\n//       signal:abortController.signal\n//     })\n//     .then(responce =>{\n//       return responce.json()\n//     })\n//     .then(result => {\n//       if(result.message){\n//         return \"\"\n//       }else{\n//         let res\n//         if(result.user.avatar){\n//           res = {...result.user,authorization:true,picture:`${url}uploads/${result.user.avatar}`} \n//         } else {\n//           res = {...result.user,authorization:true,picture:\"default\"} \n//         }\n//         store.dispatch({type:'SET_USER_DATA',payload:res})\n//       }\n//     })\n//   }else if(method == \"google\"&&!token){\n//     let objUser = JSON.parse(JSON.stringify(user))\n//     fetch(`https://oauth2.googleapis.com/tokeninfo?id_token=${value}`,{signal:abortController.signal})\n//     .then((res)=>res.json())\n//     .then((result)=>{\n//       if(result.error){\n//         localStorage.clear();\n//         store.dispatch({type:'SET_LOGOUT'})\n//         return \"\"\n//       }\n//       objUser.lastname  = result.family_name\n//       objUser.firstname = result.given_name\n//       objUser.picture   = result.picture\n//       objUser.email     = result.email\n//       const res = {...objUser,authorization:true} \n//       store.dispatch({type:'SET_USER_DATA',payload:res})\n//     })\n//   }\n// }\nuseEffect(function(){var google=localStorage.getItem(\"google\");if(google){var objUser=JSON.parse(JSON.stringify(user));fetch(\"https://oauth2.googleapis.com/tokeninfo?id_token=\".concat(google),{signal:abortController.signal}).then(function(res){return res.json();}).then(function(result){if(result.error){localStorage.clear();store.dispatch({type:'SET_LOGOUT'});}else{objUser.lastname=result.family_name;objUser.firstname=result.given_name;objUser.picture=result.picture;objUser.email=result.email;var res=_objectSpread(_objectSpread({},objUser),{},{authorization:true});store.dispatch({type:'SET_USER_DATA',payload:res});}});}else{fetch(\"\".concat(url,\"useroute/user/\"),{method:\"POST\",headers:{'Content-Type':'application/json;charset=utf-8',\"Authorization\":\"Bearer \".concat(token)},signal:abortController.signal}).then(function(responce){return responce.json();}).then(function(result){if(result.message){}else{var res;if(result.user.avatar){res=_objectSpread(_objectSpread({},result.user),{},{authorization:true,picture:\"\".concat(url,\"uploads/\").concat(result.user.avatar)});}else{res=_objectSpread(_objectSpread({},result.user),{},{authorization:true,picture:\"default\"});}store.dispatch({type:'SET_USER_DATA',payload:res});}});}return function(){abortController.abort();};},[setList]);return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"wrapper\",children:/*#__PURE__*/_jsxs(Router,{children:[/*#__PURE__*/_jsx(Header,{auth:function auth(){return setList(Math.random());}}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",component:HomePage}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/reg-page\",component:RegForm}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/login-page\",component:LoginForm}),/*#__PURE__*/_jsx(Route,{path:\"/ask-question\",component:AskQuestionPage}),/*#__PURE__*/_jsx(Route,{path:\"/specialists\",component:SpecialistsPage}),/*#__PURE__*/_jsx(Route,{path:\"/events\",component:EventsPage}),/*#__PURE__*/_jsx(Route,{path:\"/event\",component:EventPage}),/*#__PURE__*/_jsx(Route,{path:\"/tariffs\",component:Tariffs}),/*#__PURE__*/_jsx(Route,{path:\"/event-redactor\",component:function component(){return/*#__PURE__*/_jsx(EventPage,{variant:\"redactor\"});}}),/*#__PURE__*/_jsx(Route,{path:\"/pagecoorse/:id\",component:function component(){return/*#__PURE__*/_jsx(EventPage,{});}}),/*#__PURE__*/_jsx(Route,{path:\"/edit-user-profile\",component:EditUserProfile}),/*#__PURE__*/_jsx(Route,{path:\"/user-profile\",component:UserProfile}),/*#__PURE__*/_jsx(Route,{path:\"/google/callback/:token\",component:AuthGoogleToken}),/*#__PURE__*/_jsx(Route,{path:\"/facebook/callback/:token\",component:AuthFacebookToken}),/*#__PURE__*/_jsx(Route,{path:\"/auth/check_key/:id\",component:AuthCheckKey}),/*#__PURE__*/_jsx(Route,{component:NotFound})]})]})}),/*#__PURE__*/_jsx(Footer,{})]});}export default withRouter(App);","map":{"version":3,"names":["React","useEffect","useState","BrowserRouter","Router","withRouter","Switch","Route","HomePage","AskQuestionPage","SpecialistsPage","EventsPage","EventPage","EditUserProfile","UserProfile","AuthGoogleToken","AuthFacebookToken","AuthCheckKey","Tariffs","NotFound","Header","LoginForm","RegForm","useDispatch","useSelector","connect","store","Footer","url","App","history","dispatch","sd","setList","token","localStorage","getItem","user","state","Auth","abortController","AbortController","google","objUser","JSON","parse","stringify","fetch","signal","then","res","json","result","error","clear","type","lastname","family_name","firstname","given_name","picture","email","authorization","payload","method","headers","responce","message","avatar","abort","Math","random"],"sources":["/var/www/netlear/html/clientNetlear/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport \"./App.scss\";\nimport \"antd/dist/antd.css\"; // or 'antd/dist/antd.less'\nimport {\n  BrowserRouter as Router,\n  withRouter,\n  Switch,\n  Route,\n} from \"react-router-dom\";\n\nimport {\n  HomePage,\n  AskQuestionPage,\n  SpecialistsPage,\n  EventsPage,\n  EventPage,\n  EditUserProfile,\n  UserProfile,\n  AuthGoogleToken,\n  AuthFacebookToken,\n  AuthCheckKey,\n  Tariffs\n} from \"./views\";\n\nimport NotFound from \"./views/NotFound/NotFound\";\nimport Header from \"./views/Header/Header\";\nimport LoginForm from \"./components/LoginForm/LoginForm\";\nimport RegForm from \"./components/RegForm/RegForm\";\nimport { useDispatch, useSelector, connect } from \"react-redux\";\nimport store from \"./redux/store\";\nimport Footer from \"./components/Footer/Footer\";\nimport { url } from \"./conf\";\n\n\nfunction App({ history }) {\n  const dispatch = useDispatch();\n  const [sd, setList] = useState(\"\")\n  const token = localStorage.getItem('token')\n  const user = useSelector(state => state.Auth)\n  const abortController = new AbortController()\n\n  // const getUser = (method,value) =>{\n  //   if(token){\n  //     fetch(`${url}useroute/user/`,{\n  //       method:\"POST\",\n  //       headers: {\n  //         'Content-Type': 'application/json;charset=utf-8',\n  //         \"Authorization\":`Bearer ${token}`\n  //       },\n  //       signal:abortController.signal\n  //     })\n  //     .then(responce =>{\n  //       return responce.json()\n  //     })\n  //     .then(result => {\n  //       if(result.message){\n  //         return \"\"\n  //       }else{\n  //         let res\n  //         if(result.user.avatar){\n  //           res = {...result.user,authorization:true,picture:`${url}uploads/${result.user.avatar}`} \n  //         } else {\n  //           res = {...result.user,authorization:true,picture:\"default\"} \n  //         }\n  //         store.dispatch({type:'SET_USER_DATA',payload:res})\n  //       }\n  //     })\n  //   }else if(method == \"google\"&&!token){\n  //     let objUser = JSON.parse(JSON.stringify(user))\n\n  //     fetch(`https://oauth2.googleapis.com/tokeninfo?id_token=${value}`,{signal:abortController.signal})\n  //     .then((res)=>res.json())\n  //     .then((result)=>{\n  //       if(result.error){\n  //         localStorage.clear();\n  //         store.dispatch({type:'SET_LOGOUT'})\n  //         return \"\"\n  //       }\n  //       objUser.lastname  = result.family_name\n  //       objUser.firstname = result.given_name\n  //       objUser.picture   = result.picture\n  //       objUser.email     = result.email\n  //       const res = {...objUser,authorization:true} \n  //       store.dispatch({type:'SET_USER_DATA',payload:res})\n  //     })\n  //   }\n  // }\n\n  useEffect(()=>{\n    const google = localStorage.getItem(\"google\")\n\n    if(google){\n      let objUser = JSON.parse(JSON.stringify(user))\n\n      fetch(`https://oauth2.googleapis.com/tokeninfo?id_token=${google}`,{signal:abortController.signal})\n      .then((res)=>res.json())\n      .then((result)=>{\n        if(result.error){\n          localStorage.clear();\n          store.dispatch({type:'SET_LOGOUT'})\n        } else {\n          objUser.lastname  = result.family_name\n          objUser.firstname = result.given_name\n          objUser.picture   = result.picture\n          objUser.email     = result.email\n          const res = {...objUser,authorization:true} \n          store.dispatch({type:'SET_USER_DATA',payload:res})\n        }\n      })\n    } else {\n      fetch(`${url}useroute/user/`,{\n        method:\"POST\",\n        headers: {\n          'Content-Type': 'application/json;charset=utf-8',\n          \"Authorization\":`Bearer ${token}`\n        },\n        signal:abortController.signal\n      })\n      .then(responce =>{\n        return responce.json()\n      })\n      .then(result => {\n        if(result.message){\n        }else{\n          let res\n          if(result.user.avatar){\n            res = {...result.user,authorization:true,picture:`${url}uploads/${result.user.avatar}`} \n          } else {\n            res = {...result.user,authorization:true,picture:\"default\"} \n          }\n          store.dispatch({type:'SET_USER_DATA',payload:res})\n        }\n      })\n    }\n    return () => { abortController.abort() }\n  },[setList])\n\n  return (\n    <div className=\"App\">\n      <div className=\"wrapper\">\n        <Router>\n          <Header auth={()=>setList(Math.random())}/>\n          <Switch>\n            <Route exact path=\"/\" component={HomePage} />\n            <Route exact path=\"/reg-page\" component={RegForm} />\n            <Route exact path=\"/login-page\" component={LoginForm} />\n            <Route path=\"/ask-question\" component={AskQuestionPage} />\n            <Route path=\"/specialists\" component={SpecialistsPage} />\n            <Route path=\"/events\" component={EventsPage} />\n            <Route path=\"/event\" component={EventPage} />\n            <Route path=\"/tariffs\" component={Tariffs} />\n            <Route\n              path=\"/event-redactor\"\n              component={() => <EventPage variant=\"redactor\" />}\n            />\n            <Route\n              path=\"/pagecoorse/:id\"\n              component={() => <EventPage/>}\n            />\n            <Route path=\"/edit-user-profile\" component={EditUserProfile} />\n            <Route path=\"/user-profile\" component={UserProfile} />\n            <Route path=\"/google/callback/:token\" component={AuthGoogleToken} />\n            <Route\n              path=\"/facebook/callback/:token\"\n              component={AuthFacebookToken}\n            />\n            <Route path=\"/auth/check_key/:id\" component={AuthCheckKey} />\n            <Route component={NotFound} />\n          </Switch>\n        </Router>\n      </div>\n      <Footer/>\n    </div>\n  );\n}\n\nexport default withRouter(App);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}